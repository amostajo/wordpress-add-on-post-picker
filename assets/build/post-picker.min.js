/*! post-picker Built date:2018-12-16 */
!function(a){var b=new Vue({el:"#post-picker-addon",data:{callerID:0,opened:!1,isLoading:!1,allowMultiple:!0,filter:{},selected:[],showType:!0},computed:{hasData:function(){return Object.keys(this.results).length>0}},methods:{browse:function(){this.isLoading=!0,this.$http.get(this.generateUrl(),function(a){this.$set("results",this.merge(a)),this.isLoading=!1})},onAddSelection:function(){a.event.trigger("postselected",[this.selected,this.callerID]),this.onClose()},onSubmit:function(a){a.preventDefault(),this.browse()},onClose:function(b){void 0!=b&&b.preventDefault(),this.clear(),this.callerID=0,a(this.$el).css("display","none")},onSelect:function(a){this.results[a].selected=!this.results[a].selected,this.results[a].selected?this.add(this.results[a]):this.remove(this.results[a])},getPostIndex:function(a){for(var b in this.results)if(this.results[b].ID==a)return b;return void 0},add:function(a){this.allowMultiple||this.clear(),this.selected.push(a)},remove:function(a){for(var b=Object.keys(this.selected).length-1;b>=0;--b)if(this.selected[b].ID==a.ID){this.selected.splice(b,1);break}},clear:function(){for(var a=Object.keys(this.selected).length-1;a>=0;--a){var b=this.getPostIndex(this.selected[a].ID);void 0!=b&&(this.results[b].selected=!1),this.remove(this.selected[a])}},generateUrl:function(){var b=a(this.$el).data("url");for(var c in this.filter)b+="&"+c+"="+this.filter[c];return b},merge:function(b){var c=[];for(var d in this.selected){var e=!1;for(var f in b)if(b[f].ID==this.selected[d].ID){b[f].selected=!0,e=!0;break}e||c.push(this.selected[d])}return a.merge(b,c)}},ready:function(){this.browse()}});a.fn.postPicker=function(c){var d=this;d.settings=a.extend({allowMultiple:!0,render:!0,clearTemplate:!0,clearTarget:!0,target:void 0,success:void 0,template:void 0,templateElement:void 0,type:void 0,ID:0},c),d.init=function(){d.settings.ID=Math.floor(1000000001*Math.random()),a(d).click(function(c){c.preventDefault(),b.opened=!0,b.callerID=d.settings.ID,b.showType=void 0==d.settings.type,b.filter.type=void 0==d.settings.type?"post":d.settings.type,b.browse(),a(b.$el).css("display","block")}),b.allowMultiple=d.settings.allowMultiple,a(document).on("postselected",d.handler),void 0==d.settings.template&&(void 0==d.settings.templateElement||0==a(d.settings.templateElement).length?(d.settings.template=a(d).html(),d.settings.clearTemplate&&a(d).html("")):(d.settings.template=a(d.settings.templateElement).html(),d.settings.clearTemplate&&a(d.settings.templateElement).html("")))},d.handler=function(a,b,c){d.settings.ID==c&&(d.settings.render&&d.render(b),void 0!=d.settings.success&&d.settings.success(b))},d.render=function(b){d.settings.render&&void 0!=a(d.settings.target)&&(d.settings.clearTarget&&a(d.settings.target).html(""),a.each(b,function(b){a(d.settings.target).append(d.parsePost(this))}))},d.parsePost=function(b){if(void 0!=b){var c=d.settings.template;return a.each(b,function(a){c=c.replace(new RegExp("{{"+a+"}}","g"),this,c),c=c.replace(new RegExp("{{ "+a+" }}","g"),this,c)}),c=a(c),c.find("img").length>0&&c.find("img").attr("src",b.thumb_image_url),c}},d.init()}}(jQuery);